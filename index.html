<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Buscador 380V</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
html, body {
  margin: 0;
  padding: 0;
  width: 100%;
  height: 100%;
  font-family: Arial, sans-serif;
  overflow: hidden;
}

/* ===== PANTALLAS ===== */
.pantalla {
  position: absolute;
  inset: 0;
  display: none;
}

.pantalla.activa {
  display: flex;
}

/* ===== INICIO ===== */
#inicio {
  background: black;
  align-items: center;
  justify-content: center;
}

#inicio img {
  max-width: 100%;
  max-height: 100%;
  object-fit: contain;
  cursor: pointer;
}

/* ===== BUSCADOR ===== */
#buscador {
  background-image: url("Sala.jpg");
  background-size: cover;
  background-position: center;
  align-items: center;
  justify-content: center;
}

.overlay {
  position: absolute;
  inset: 0;
  background: rgba(0,0,0,0.45);
}

.content {
  position: relative;
  z-index: 2;
  color: white;
  text-align: center;
  width: 90%;
  max-width: 900px;
}

h1 {
  color: #5DDE82;
}

select, input {
  font-size: 1.4rem;
  padding: 11px 15px;
  border-radius: 6px;
  border: none;
  margin-bottom: 15px;
  width: 100%;
  max-width: 420px;
}

button {
  font-size: 1.2rem;
  padding: 15px 30px;
  border: none;
  border-radius: 8px;
  background: #00e0ff;
  cursor: pointer;
}

button:hover {
  background: #00bcd4;
}

/* ===== RESULTADOS ===== */
#resultadosPantalla {
  background: #111;
  flex-direction: column;
  padding: 20px;
  box-sizing: border-box;
}

.resultados-container {
  flex: 1;
  overflow-y: auto;
  margin-bottom: 20px;
  padding-right: 10px;
}

.resultados {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
  gap: 15px;
}

.card {
  background: white;
  color: black;
  border-radius: 8px;
  padding: 15px;
  box-shadow: 0 4px 10px rgba(0,0,0,0.25);
}

.equipo {
  font-weight: bold;
  font-size: 1.2rem;
}

.desc {
  font-size: 0.95rem;
  color: #333;
}

.volver {
  align-self: center;
}
</style>
</head>

<body>

<!-- ===== PANTALLA 0 ===== -->
<div id="inicio" class="pantalla activa">
  <img src="inicio.jpg" alt="Entrar" onclick="entrar()">
</div>

<!-- ===== PANTALLA 1 ===== -->
<div id="buscador" class="pantalla">
  <div class="overlay"></div>

  <div class="content">
    <h1>UNIDAD GUE13</h1>
    <h1>Buscar Equipos de 380V</h1>

    <select id="barra">
      <option value="Todas">Todas las Barras</option>
      <option value="3 CA">3 CA</option>
      <option value="3 CC">3 CC</option>
      <option value="3 DZ">3 DZ</option>
      <option value="3 OCA">3 OCA</option>
      <option value="3 OCN">3 OCN</option>
      <option value="3 OCP">3 OCP</option>
    </select><br>

    <input id="busqueda" type="text" placeholder="Ej: RL, RN, VG"><br>

    <button onclick="buscar()">Buscar</button>
  </div>
</div>

<!-- ===== PANTALLA 2 ===== -->
<div id="resultadosPantalla" class="pantalla">
  <div class="resultados-container">
    <div id="resultados" class="resultados"></div>
  </div>

  <button class="volver" onclick="volver()">â¬… Volver al buscador</button>
</div>

<script>
let datos = [];

/* === ENTRAR === */
function entrar() {
  const el = document.documentElement;
  if (el.requestFullscreen) el.requestFullscreen();

  activar("buscador");
}

/* === CAMBIAR PANTALLA === */
function activar(id) {
  document.querySelectorAll(".pantalla").forEach(p => p.classList.remove("activa"));
  document.getElementById(id).classList.add("activa");
}

/* === CARGAR CSV === */
fetch("380.csv")
  .then(r => r.text())
  .then(t => {
    const l = t.split("\n");
    datos = l.slice(1).filter(x => x.trim()).map(x => {
      const c = x.split(";");
      return {
        equipo: c[0]?.trim(),
        descripcion: c[1]?.trim(),
        barra: c[2]?.trim()
      };
    });
  });

/* === BUSCAR === */
function buscar() {
  const texto = busqueda.value.toLowerCase();
  const barra = document.getElementById("barra").value;
  const res = document.getElementById("resultados");
  res.innerHTML = "";

  if (!texto) return;

  datos.filter(d =>
    d.equipo &&
    d.equipo.toLowerCase().includes(texto) &&
    (barra === "Todas" || d.barra === barra)
  ).forEach(d => {
    const c = document.createElement("div");
    c.className = "card";
    c.innerHTML = `
      <div class="equipo">${d.equipo}</div>
      <div class="desc">${d.descripcion}</div>
    `;
    res.appendChild(c);
  });

  activar("resultadosPantalla");
}

/* === VOLVER === */
function volver() {
  activar("buscador");
}
</script>

</body>
</html>
